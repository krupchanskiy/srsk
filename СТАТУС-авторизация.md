# –°—Ç–∞—Ç—É—Å –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## ‚úÖ –ß—Ç–æ —É–∂–µ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞ (`login.html`)
- ‚úÖ –°–æ–∑–¥–∞–Ω `js/auth-check.js` - middleware –¥–ª—è –∑–∞—â–∏—Ç—ã —Å—Ç—Ä–∞–Ω–∏—Ü
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `logout()` –≤ `js/layout.js`
- ‚úÖ –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ header (desktop –∏ mobile)
- ‚úÖ –ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –∫–Ω–æ–ø–∫–∏ –≤—ã—Ö–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –ë–î

### 2. –ó–∞—â–∏—Ç–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω `auth-check.js` –≤ 37 HTML —Ñ–∞–π–ª–æ–≤:**
- vaishnavas: guests.html, team.html, index.html, preliminary.html, retreat-guests.html, person.html
- settings: users.html, translations.html
- index.html
- ashram: retreats.html, festivals.html
- reception: floor-plan.html, floor-plan-editor.html, cleaning.html, rooms.html, dictionaries.html, buildings.html
- stock: stock-settings.html, inventory.html, requests.html, issue.html, receive.html, stock.html
- kitchen: menu-templates.html, recipe-edit.html, products.html, menu.html, recipe.html, dictionaries.html, recipes.html
- placement: transfers.html, arrivals.html, timeline.html, bookings.html, departures.html

### 3. –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω `admin-create-accounts.html` —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏ Service Role Key
- ‚úÖ –°–æ–∑–¥–∞–Ω SQL-—Å–∫—Ä–∏–ø—Ç `supabase/072_create_team_accounts.sql`
- ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è `–ò–ù–°–¢–†–£–ö–¶–ò–Ø-—Å–æ–∑–¥–∞–Ω–∏–µ-–∞–∫–∫–∞—É–Ω—Ç–æ–≤.md`

---

## üîÑ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –°–ï–ô–ß–ê–°

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã

–°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ —Ñ–∞–π–ª–µ **`–ò–ù–°–¢–†–£–ö–¶–ò–Ø-—Å–æ–∑–¥–∞–Ω–∏–µ-–∞–∫–∫–∞—É–Ω—Ç–æ–≤.md`**

**–ë—ã—Å—Ç—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:**
1. –ü–æ–ª—É—á–∏—Ç–µ Service Role Key –≤ [Supabase Dashboard ‚Üí Settings ‚Üí API](https://supabase.com/dashboard/project/llttmftapmwebidgevmg/settings/api)
2. –û—Ç–∫—Ä–æ–π—Ç–µ `admin-create-accounts.html` –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ
3. –í—Å—Ç–∞–≤—å—Ç–µ –∫–ª—é—á –≤ —Å—Ç—Ä–æ–∫—É 37
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –æ—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª –≤ –±—Ä–∞—É–∑–µ—Ä–µ
5. –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã"
6. **–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û** —É–¥–∞–ª–∏—Ç–µ Service Role Key –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è!

**–°–ø–∏—Å–æ–∫ —Å–æ–∑–¥–∞–≤–∞–µ–º—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (20 —á–µ–ª–æ–≤–µ–∫):**
- adrian@adrian.ru (–ê—á–∏–Ω—Ç—å—è –ö—Ä–∏—à–Ω–∞ –¥–∞—Å)
- amalakamala@rupaseva.com (–ê–º–∞–ª–∞-–ö–∞–º–∞–ª–∞ –¥–µ–≤–∏ –¥–∞—Å–∏)
- anangamanjari@rupaseva.com (–ê–Ω–∞–Ω–≥–∞-–ú–∞–Ω–¥–∂–∞—Ä–∏ –¥–µ–≤–∏ –¥–∞—Å–∏)
- ... –∏ –µ—â—ë 17 —á–µ–ª–æ–≤–µ–∫

**–ü–∞—Ä–æ–ª—å –¥–ª—è –≤—Å–µ—Ö:** `rupaseva`

### –®–∞–≥ 2: –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://in.rupaseva.com –≤ –ø—Ä–∏–≤–∞—Ç–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ /login.html
3. –í–æ–π–¥–∏—Ç–µ —Å –æ–¥–Ω–∏–º –∏–∑ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, adrian@adrian.ru / rupaseva)
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ:
   - ‚úÖ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏–ª–æ –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
   - ‚úÖ –ö–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ header (—Å–ø—Ä–∞–≤–∞ –≤–≤–µ—Ä—Ö—É)
   - ‚úÖ –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –¥—Ä—É–≥–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ª–æ–≥–∏–Ω —Å–Ω–æ–≤–∞
   - ‚úÖ –ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ "–í—ã—Ö–æ–¥" –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ login.html
   - ‚úÖ –ü–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –ø–æ–ø—ã—Ç–∫–∞ –∑–∞–π—Ç–∏ –Ω–∞ –ª—é–±—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É ‚Üí —Å–Ω–æ–≤–∞ login.html

### –®–∞–≥ 3: –°–º–µ—Ä–∂–∏—Ç—å –≤ main

–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
cd "/Users/adrian/Library/CloudStorage/OneDrive-Personal/–†–∞–±–æ—á–∏–π —Å—Ç–æ–ª/–ø—Ä–æ–µ–∫—Ç—ã/–ò–ò/–®–†–°–ö"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git status
git diff

# –ó–∞–∫–æ–º–º–∏—Ç–∏—Ç—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "–î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü

- –£–ø—Ä–æ—â–µ–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞ (email + –ø–∞—Ä–æ–ª—å)
- –°–æ–∑–¥–∞–Ω auth-check.js –¥–ª—è –∑–∞—â–∏—Ç—ã –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ –≤—ã—Ö–æ–¥–∞ –≤ header
- –ó–∞—â–∏—â–µ–Ω—ã –≤—Å–µ 37 HTML —Å—Ç—Ä–∞–Ω–∏—Ü
- –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –º–∞—Å—Å–æ–≤–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–æ–≤

Co-Authored-By: Claude Opus 4.5 <noreply@anthropic.com>"

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ main
git checkout main

# –°–º–µ—Ä–∂–∏—Ç—å auth –≤–µ—Ç–∫—É
git merge auth

# –ó–∞–ø—É—à–∏—Ç—å –Ω–∞ GitHub (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π)
git push origin main

# –£–¥–∞–ª–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é auth –≤–µ—Ç–∫—É (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
git branch -d auth
```

### –®–∞–≥ 4: –†–∞–∑–¥–∞—Ç—å –¥–æ—Å—Ç—É–ø—ã –∫–æ–º–∞–Ω–¥–µ

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:

1. –°–æ–æ–±—â–∏—Ç–µ –∫–æ–º–∞–Ω–¥–µ, —á—Ç–æ —Ç–µ–ø–µ—Ä—å –Ω—É–∂–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
2. –†–∞–∑–¥–∞–π—Ç–µ –∫–∞–∂–¥–æ–º—É –∏—Ö email –∏ –ø–∞—Ä–æ–ª—å `rupaseva`
3. –†–µ–∫–æ–º–µ–Ω–¥—É–π—Ç–µ —Å–º–µ–Ω–∏—Ç—å –ø–∞—Ä–æ–ª—å (—Ñ—É–Ω–∫—Ü–∏—é —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ)

---

## üìã –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞—â–∏—Ç–∞

1. **auth-check.js** –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ layout.js
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–µ—Å—Å–∏—é —á–µ—Ä–µ–∑ `db.auth.getSession()`
3. –ï—Å–ª–∏ —Å–µ—Å—Å–∏–∏ –Ω–µ—Ç ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–π URL –∏ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç –Ω–∞ `/login.html`
4. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π URL
5. –°–µ—Å—Å–∏—è —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Supabase Auth (–∑–∞—â–∏—â—ë–Ω–Ω–æ)

### –ü–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–∫—Ä–∏–ø—Ç–æ–≤

```html
<script src="../js/config.js"></script>         <!-- 1. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è -->
<script src="../js/auth-check.js"></script>     <!-- 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ -->
<script src="../js/cache.js"></script>          <!-- 3. –ö—ç—à -->
<script src="../js/layout.js"></script>         <!-- 4. Layout –∏ –Ω–∞–≤–∏–≥–∞—Ü–∏—è -->
```

### RLS (Row Level Security)

–í —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:
- ‚úÖ –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞—â–∏—â–µ–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ frontend
- ‚ö†Ô∏è RLS –≤ Supabase –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ `auth.role() = 'authenticated'`
- üìù –í –±—É–¥—É—â–µ–º –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –∑–∞—â–∏—â–µ–Ω–æ
- ‚úÖ –í—Å–µ HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- ‚úÖ –°–µ—Å—Å–∏—è —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è Supabase Auth (–∑–∞—â–∏—â—ë–Ω–Ω–æ)
- ‚úÖ Service Role Key –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è –≤ Git
- ‚úÖ –ü–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ–º –≤–∏–¥–µ –≤ Supabase

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
- ‚ö†Ô∏è –ù–∞—á–∞–ª—å–Ω—ã–π –ø–∞—Ä–æ–ª—å `rupaseva` –ø—Ä–æ—Å—Ç–æ–π - —Ä–µ–∫–æ–º–µ–Ω–¥—É–π—Ç–µ –∫–æ–º–∞–Ω–¥–µ —Å–º–µ–Ω–∏—Ç—å
- ‚ö†Ô∏è Service Role Key –¥–∞—ë—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø - —Ö—Ä–∞–Ω–∏—Ç–µ –≤ —Å–µ–∫—Ä–µ—Ç–µ
- üí° –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å–º–µ–Ω—ã –ø–∞—Ä–æ–ª—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ
- üí° –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å 2FA –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
- üí° –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —Ä–æ–ª–∏ (–∞–¥–º–∏–Ω, –º–æ–¥–µ—Ä–∞—Ç–æ—Ä, –≥–æ—Å—Ç—å)

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

1. **–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –≤–º–µ—Å—Ç–æ –∞–≤–∞—Ç–∞—Ä–∞
   - –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª—è
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏

2. **–†–æ–ª–∏ –∏ –ø—Ä–∞–≤–∞**
   - –ê–¥–º–∏–Ω - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
   - –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø
   - –ì–æ—Å—Ç—å - —Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ

3. **–ò—Å—Ç–æ—Ä–∏—è –≤—Ö–æ–¥–æ–≤**
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ö–æ–¥–æ–≤/–≤—ã—Ö–æ–¥–æ–≤
   - IP-–∞–¥—Ä–µ—Å–∞ –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

4. **–£–ª—É—á—à–µ–Ω–∏—è UX**
   - "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è"
   - –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
   - –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è –ø–æ email

---

## üìû –ü–æ–º–æ—â—å

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –Ω–∞ –æ—à–∏–±–∫–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Service Role Key —É–¥–∞–ª—ë–Ω –∏–∑ `admin-create-accounts.html`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –≤ [Supabase Dashboard ‚Üí Authentication ‚Üí Users](https://supabase.com/dashboard/project/llttmftapmwebidgevmg/auth/users)
4. –ú–æ–∂–Ω–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è: `git checkout main` (auth –≤–µ—Ç–∫–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –Ω–µ—Ç—Ä–æ–Ω—É—Ç–æ–π)

---

**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤–æ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é ‚úÖ
