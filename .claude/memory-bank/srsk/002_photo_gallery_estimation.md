# Оценка: Photo Gallery & Face Search

**Задача**: Photo Gallery & Face Search — Business Logic (Short)
**Дата оценки**: 2026-02-08 (v1.5 — упрощение MVP)
**Режим**: Human + Claude
**Ограничение**: исполнитель тратит не более 3 ч/день
**Методика**: скилл `~/.claude/skills/estimation/SKILL.md` (категории A/B/C/D + формула с overhead 15%)
**Scope**: Must Have + Should Have (= MVP, упрощённый)

---

## Что упрощено в v1.5

1. **Убрана группировка по дням** → Could Have
2. **Убран прогрессбар загрузки** → простой счётчик «34/100»
3. **Убрана переиндексация** → Could Have
4. **Убран прогрессбар индексации** → Could Have
5. **Упрощён fallback-селфи** → просто `<input type="file">`
6. **Авто-сжатие без подтверждения** → сжимает молча
7. **Overhead 15%** (был 20%)

---

## Сводка (v1.5)

| Фаза | Задач | Обычный dev | Human + Claude | Мульт | Дней (3 ч/день) |
|------|-------|-----------|----------------|-------|-----------------|
| Фаза 1 — Галерея | 10 | 20.0 ч | 6.0 ч | 3.3x | 7 / 2 |
| Фаза 2 — Face Recognition | 8 | 17.0 ч | 4.6 ч | 3.7x | 6 / 1.5 |
| Фаза 3 — Telegram | 9 | 15.5 ч | 6.3 ч | 2.5x | 5-6 / 2 |
| **Итого** | **27** | **52.5 ч** | **16.9 ч** | **3.1x** | **18-19 / ~5.5** |

### Сравнение версий

| | v1.3 | v1.4 | v1.5 |
|--|------|------|------|
| H+C | 14.8 ч | 23.3 ч | **16.9 ч** |
| Дней | ~5 | 7.5-8.5 | **~5.5** |

---

## Фаза 1 — Галерея

| # | Задача | H+C (ч) |
|---|--------|---------|
| 1.1 | Permission upload_photos | 0.20 |
| 1.2 | Миграция retreat_photos | 0.25 |
| 1.3 | Storage bucket | 1.50 |
| 1.4 | RLS | 0.30 |
| 1.5 | upload.html (drag&drop + авто-сжатие + счётчик N/total + retry) | 1.20 |
| 1.6 | manage.html (grid + удаление + каскад) | 0.50 |
| 1.7 | Guest Portal галерея | 0.40 |
| 1.8 | CDN Image Transforms | 0.25 |
| 1.9 | Bulk delete | 0.57 |
| 1.10 | Скачивание фото | 0.06 |
| | **Сумма** | **5.23** |
| | **+ 15% overhead** | **6.0** |

## Фаза 2 — Face Recognition

| # | Задача | H+C (ч) |
|---|--------|---------|
| 2.1 | Миграции photo_faces + face_tags | 0.25 |
| 2.2 | EF index-faces | 1.20 |
| 2.3 | Коллекции retreat_{id} | 0.17 |
| 2.4 | EF search-face | 1.00 |
| 2.5 | UPSERT face_tags | 0.08 |
| 2.6 | «Найти себя» UI | 0.50 |
| 2.7 | Каскад DeleteFaces | 0.38 |
| 2.8 | Fallback: input file | 0.20 |
| | **Сумма** | **3.78** |
| | **+ 15% overhead** | **4.6** |

## Фаза 3 — Telegram

| # | Задача | H+C (ч) |
|---|--------|---------|
| 3.1 | Бот BotFather | 1.00 |
| 3.2 | EF telegram-webhook | 0.71 |
| 3.3 | Миграции | 0.17 |
| 3.4 | /start TOKEN | 1.17 |
| 3.5 | /stop | 0.08 |
| 3.6 | EF send-notification | 0.57 |
| 3.7 | Триггеры уведомлений | 0.50 |
| 3.8 | Guest Portal кнопки | 0.57 |
| 3.9 | Обработка ошибок (мин.) | 0.75 |
| | **Сумма** | **5.52** |
| | **+ 15% overhead** | **6.3** |

---

## Допущения

1. Все доступы готовы (Supabase, AWS, Telegram BotFather) — ПОДТВЕРЖДЕНО
2. AWS Rekognition SDK настроен — ПОДТВЕРЖДЕНО
3. Один исполнитель, без внешнего ревью
4. Требования зафиксированы (v1.5), scope не меняется
